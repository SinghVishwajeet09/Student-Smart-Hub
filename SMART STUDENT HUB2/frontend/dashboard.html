<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Smart Student Hub</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body class="dashboard-page">
    <!-- Header -->
    <header class="dashboard-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-graduation-cap"></i>
                    <span>Smart Student Hub</span>
                </div>
                <nav class="main-nav">
                    <ul>
                        <li><a href="dashboard.html" class="active"><i class="fas fa-home"></i> Dashboard</a></li>
                        <li><a href="activities.html"><i class="fas fa-trophy"></i> Activities</a></li>
                        <li><a href="portfolio.html"><i class="fas fa-file-alt"></i> Portfolio</a></li>
                        <li><a href="analytics.html"><i class="fas fa-chart-bar"></i> Analytics</a></li>
                    </ul>
                </nav>
                <div class="header-actions">
                    <div class="notification-icon" onclick="toggleNotifications()">
                        <i class="fas fa-bell"></i>
                        <span id="notificationBadge" class="notification-badge">0</span>
                    </div>
                    <div class="user-menu">
                        <div class="user-avatar" onclick="toggleUserMenu()">
                            <img id="userAvatar" src="https://via.placeholder.com/40" alt="User Avatar">
                            <span id="userName">Student</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div id="userDropdown" class="user-dropdown">
                            <a href="#" onclick="showProfileModal()"><i class="fas fa-user"></i> Profile</a>
                            <a href="#" onclick="showSettingsModal()"><i class="fas fa-cog"></i> Settings</a>
                            <div class="dropdown-divider"></div>
                            <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Welcome Section -->
            <section class="welcome-section">
                <div class="welcome-content">
                    <h1 id="welcomeTitle">Welcome back, <span id="userFirstName">Student</span>!</h1>
                    <p>Here's your comprehensive activity dashboard</p>
                    <div class="last-updated">
                        Last updated: <span id="lastUpdated">Today</span>
                    </div>
                </div>
                <div class="welcome-actions">
                    <button class="btn btn-primary" onclick="showAddActivityModal()">
                        <i class="fas fa-plus"></i> Add New Activity
                    </button>
                    <button class="btn btn-outline" onclick="generatePortfolio()">
                        <i class="fas fa-download"></i> Generate Portfolio
                    </button>
                </div>
            </section>

            <!-- Stats Cards -->
            <section class="stats-section">
                <div class="stats-grid">
                    <div class="stat-card fade-in-up">
                        <div class="stat-icon">
                            <i class="fas fa-certificate"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="totalActivities">0</h3>
                            <p>Total Activities</p>
                            <div class="stat-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span>+5 this month</span>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card fade-in-up delay-1">
                        <div class="stat-icon approved">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="approvedActivities">0</h3>
                            <p>Approved Activities</p>
                            <div class="stat-change positive">
                                <i class="fas fa-arrow-up"></i>
                                <span>+3 this month</span>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card fade-in-up delay-2">
                        <div class="stat-icon pending">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="pendingActivities">0</h3>
                            <p>Pending Approval</p>
                            <div class="stat-change neutral">
                                <i class="fas fa-minus"></i>
                                <span>No change</span>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card fade-in-up delay-3">
                        <div class="stat-icon profile">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="profileCompleteness">0%</h3>
                            <p>Profile Completeness</p>
                            <div class="stat-progress">
                                <div class="progress-bar">
                                    <div id="profileProgress" class="progress-fill" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Recent Activities -->
            <section class="activities-section">
                <div class="section-header">
                    <h2 class="section-title">Recent Activities</h2>
                    <div class="section-actions">
                        <div class="filter-dropdown">
                            <button class="btn btn-outline dropdown-toggle" onclick="toggleFilterDropdown()">
                                <i class="fas fa-filter"></i> Filter
                            </button>
                            <div id="filterDropdown" class="dropdown-menu">
                                <a href="#" onclick="filterActivities('all')">All Activities</a>
                                <a href="#" onclick="filterActivities('approved')">Approved</a>
                                <a href="#" onclick="filterActivities('pending')">Pending</a>
                                <a href="#" onclick="filterActivities('rejected')">Rejected</a>
                            </div>
                        </div>
                        <a href="activities.html" class="view-all-link">
                            View All <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                <div id="activitiesGrid" class="activities-grid">
                    <!-- Activities will be loaded dynamically -->
                    <div class="loading-placeholder">
                        <div class="skeleton-card"></div>
                        <div class="skeleton-card"></div>
                        <div class="skeleton-card"></div>
                    </div>
                </div>
                <div id="noActivities" class="empty-state" style="display: none;">
                    <i class="fas fa-clipboard-list"></i>
                    <h3>No activities yet</h3>
                    <p>Start by adding your first activity to build your portfolio</p>
                    <button class="btn btn-primary" onclick="showAddActivityModal()">
                        <i class="fas fa-plus"></i> Add Your First Activity
                    </button>
                </div>
            </section>

            <!-- Quick Actions -->
            <section class="quick-actions-section">
                <div class="section-header">
                    <h2 class="section-title">Quick Actions</h2>
                </div>
                <div class="quick-actions-grid">
                    <div class="quick-action-card" onclick="showAddActivityModal()">
                        <i class="fas fa-plus"></i>
                        <h3>Add Activity</h3>
                        <p>Document a new achievement or participation</p>
                    </div>
                    <div class="quick-action-card" onclick="generatePortfolio()">
                        <i class="fas fa-file-pdf"></i>
                        <h3>Generate Portfolio</h3>
                        <p>Create a verified PDF portfolio</p>
                    </div>
                    <div class="quick-action-card" onclick="location.href='analytics.html'">
                        <i class="fas fa-chart-line"></i>
                        <h3>View Analytics</h3>
                        <p>Track your progress and insights</p>
                    </div>
                    <div class="quick-action-card" onclick="showProfileModal()">
                        <i class="fas fa-user-edit"></i>
                        <h3>Update Profile</h3>
                        <p>Keep your information up to date</p>
                    </div>
                </div>
            </section>

            <!-- Portfolio Preview -->
            <section class="portfolio-preview-section">
                <div class="portfolio-preview-card">
                    <div class="portfolio-icon">
                        <i class="fas fa-file-pdf"></i>
                    </div>
                    <div class="portfolio-content">
                        <h3>Your Digital Portfolio</h3>
                        <p>Create a downloadable and shareable verified student portfolio in PDF format. Showcase your achievements to employers and higher education institutions.</p>
                    </div>
                    <div class="portfolio-actions">
                        <button class="btn btn-primary" onclick="generatePortfolio()">
                            <i class="fas fa-download"></i> Generate PDF Portfolio
                        </button>
                        <button class="btn btn-outline" onclick="location.href='portfolio.html'">
                            <i class="fas fa-eye"></i> Preview Portfolio
                        </button>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Add Activity Modal -->
    <div id="addActivityModal" class="modal large-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-plus"></i> Add New Activity</h2>
                <button class="modal-close" onclick="hideAddActivityModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addActivityForm" class="activity-form" enctype="multipart/form-data">
                <div class="form-step active" data-step="1">
                    <h3>Basic Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="activityTitle">Activity Title *</label>
                            <input type="text" id="activityTitle" name="title" required>
                        </div>
                        <div class="form-group">
                            <label for="activityType">Activity Type *</label>
                            <select id="activityType" name="activityType" required>
                                <option value="">Select type</option>
                                <option value="academic">Academic</option>
                                <option value="extracurricular">Extracurricular</option>
                                <option value="sports">Sports</option>
                                <option value="cultural">Cultural</option>
                                <option value="technical">Technical</option>
                                <option value="social_service">Social Service</option>
                                <option value="internship">Internship</option>
                                <option value="certification">Certification</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="activityDescription">Description *</label>
                        <textarea id="activityDescription" name="description" required placeholder="Describe your activity, role, and key outcomes..."></textarea>
                    </div>
                </div>

                <div class="form-step" data-step="2">
                    <h3>Activity Details</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="startDate">Start Date *</label>
                            <input type="date" id="startDate" name="startDate" required>
                        </div>
                        <div class="form-group">
                            <label for="endDate">End Date</label>
                            <input type="date" id="endDate" name="endDate">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="durationHours">Duration (Hours)</label>
                            <input type="number" id="durationHours" name="durationHours" min="1">
                        </div>
                        <div class="form-group">
                            <label for="venue">Venue</label>
                            <input type="text" id="venue" name="venue">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="organizer">Organizer</label>
                            <input type="text" id="organizer" name="organizer">
                        </div>
                        <div class="form-group">
                            <label for="roleInActivity">Your Role</label>
                            <input type="text" id="roleInActivity" name="roleInActivity" placeholder="e.g., Participant, Organizer, Speaker">
                        </div>
                    </div>
                </div>

                <div class="form-step" data-step="3">
                    <h3>Achievements & Skills</h3>
                    <div class="form-group">
                        <label for="achievement">Achievement/Award</label>
                        <input type="text" id="achievement" name="achievement" placeholder="e.g., First Place, Certificate of Excellence">
                    </div>
                    <div class="form-group">
                        <label for="skillsGained">Skills Gained</label>
                        <input type="text" id="skillsGained" name="skillsGained" placeholder="e.g., Leadership, Public Speaking, Programming">
                        <small>Separate multiple skills with commas</small>
                    </div>
                    <div class="form-group">
                        <label for="documents">Upload Documents</label>
                        <div class="file-upload-area">
                            <input type="file" id="documents" name="documents" multiple accept=".pdf,.doc,.docx,.jpg,.jpeg,.png">
                            <div class="file-upload-content">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <p>Drag & drop files here or click to browse</p>
                                <small>Supported: PDF, DOC, DOCX, JPG, PNG (Max 10MB each)</small>
                            </div>
                        </div>
                        <div id="selectedFiles" class="selected-files"></div>
                    </div>
                </div>

                <div class="form-navigation">
                    <button type="button" id="prevStepBtn" class="btn btn-outline" onclick="previousStep()" style="display: none;">
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button type="button" id="nextStepBtn" class="btn btn-primary" onclick="nextStep()">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                    <button type="submit" id="submitActivityBtn" class="btn btn-primary" style="display: none;">
                        <i class="fas fa-save"></i> Save Activity
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Notification Panel -->
    <div id="notificationPanel" class="notification-panel">
        <div class="notification-header">
            <h3><i class="fas fa-bell"></i> Notifications</h3>
            <button class="btn btn-text" onclick="markAllNotificationsRead()">
                Mark all as read
            </button>
        </div>
        <div id="notificationList" class="notification-list">
            <!-- Notifications will be loaded dynamically -->
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p id="loadingText">Loading...</p>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer" class="notification-container"></div>

    <!-- Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/activities.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/app.js"></script>

    <script>
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            initializeDashboard();
            loadUserProfile();
            loadDashboardData();
            setupWebSocket();
        });
    </script>
</body>
</html>
